<html>

<head>

<script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0"></script>

<script type="text/javascript">

var map = null;         

function GetMap() {

        // Initialize the map
        map = new Microsoft.Maps.Map(
		document.getElementById("myMap"), 
		{credentials:"AjHyO0DafhJA9zV9yn3LR0pGvBWIhzfY23PRa8O_eadGopb5Tb4L0fnUPF04B1BX"}
	); //keepforest.azurewebsites.net

        //Add handler for the map click event.
	Microsoft.Maps.Events.addHandler(map, 'click', trapEventInfo);

	map.entities.clear(); 
	var geoLocationProvider = new Microsoft.Maps.GeoLocationProvider(map);  

	geoLocationProvider.getCurrentPosition(
	{ successCallback: 
		function(object) { 

			//set start map as detected location, and display location info
			displayLocationInfo(object.center); 
	                document.getElementById("sensor").value = '_';

		}
	},
	{ errorCallback: 
		function(object) { 

			//set start map as Thailand
			map.setView({zoom: 5, center: new Microsoft.Maps.Location(13.77351,100.56875) });
	                document.getElementById("sensor").value = '.';
		
		} 	
	}
	); 

}

function trapEventInfo(e) {

        if (e.targetType == "map") {

                var point = new Microsoft.Maps.Point(e.getX(), e.getY());
                var loc = e.target.tryPixelToLocation(point);

		displayLocationInfo(loc);

        }

}

function displayLocationInfo(loc) {

                document.getElementById("lat").value = loc.latitude;
                document.getElementById("lng").value = loc.longitude;

}


</script>

</head>

<body onload="GetMap();">

<!-- a href='ImInAJungle_WebFull'>go</a -->

<div id='myMap' style="position:relative; width:700px; height:500px;"></div><br>
<b>คลิกแผนที่ ณ ตำแหน่งที่ต้องการตรวจสอบว่าอยู่ในเขตป่าสงวนหรือไม่</b><br>

<form method='post' action="http://protection.forest.go.th/gis/common.ajax.php" enctype='application/x-www-form-urlencoded' target='location_info'>

<b>ใส่ค่าตำแหน่งที่ต้องการตรวจสอบว่าอยู่ในเขตป่าสงวนหรือไม่</b><br>
lat = <input type='text' name='lat' id='lat' width=20>, 
lng = <input type='text' name='lng' id='lng' width=20>, 
mode = <input type='hidden' name='mode' id='mode' value='get_forest_info' readonly='true'><br>
<br>
<input type='submit' name='submit' id='submit' value='ตรวจสอบ'><input type='text' name='sensor' id='sensor' width=1>, 


</form>

</body>

</html>

<!--

            var z = "mode=get_forest_info"
            + "&lat="+tn.gmap.m.right_click.lat
            + "&lng="+tn.gmap.m.right_click.lng

,z,fn)
        }
        tn.gmap.e.on_right_click(get_forest_info)
    }

-->